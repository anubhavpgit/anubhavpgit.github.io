<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="icon" href="/favicon.ico" />
    <meta name="description" content="The tech behind the spreadsheet monster." />
    <meta name="publish-date" content="2023-06-11" />
    <meta name="author" content="<!-- AUTHOR -->" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/manifest.json" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx"
      crossorigin="anonymous"
    />

    <title>StackIt-tech | Anubhab's blogs</title>

    <link rel="stylesheet" href="/assets/css/style.css" />
    <link rel="stylesheet" href="/assets/css/hljs.css" />
  </head>

  <body class="markdown-body">
    <div>
      <div class="f6">
        <header id="header" class="measure-wide center mt6 mb4">
          <nav>
            <div class="mb2 dib">
              <img
                src="/android-chrome-192x192.png"
                alt="logo"
                class="logo mr1"
                style="width: 25px; height: 25px; border-radius: 50%"
              />
              <a href="/current.html" title="blog" class="gray link">current</a>
              . <a href="/blog" title="blog" class="gray link active">blog</a> .
              <a href="/" title="about" class="gray link">about</a>
            </div>
            <div>
              <a href="/blog/feed.xml" title="anubhab" class="rss gray link"
                >/rss</a
              >
            </div>
          </nav>
          <h2 class="f2 lh-title mb2 mt-2">
            StackIt-tech
          </h2>
          <div>
            <p>
              The tech behind the spreadsheet monster.
            </p>
          </div>
          <h4 class="f4 lh-title gray">
            <!-- AUTHOR -->
          </h4>
        </header>
        <section id="main" class="page-post gray mb6 lh-copy">
          <ul class="ph0" style="list-style: none">
            <li class="pb3">
              2023-06-11
            </li>
          </ul>
          <div class="content custom">
            <p>StackIt empowers you to automate the data importing process into your spreadsheets, making it more efficient and hassle-free. By eliminating the need for coding, StackIt enables users of all backgrounds to effortlessly create connections with various data sources and seamlessly import relevant data into their spreadsheets.</p>
<ul>
<li><a href="#how-does-it-work">How does it work?</a>
<ul>
<li><a href="#infrastructure">Infrastructure</a>
<ul>
<li><a href="#the-plugin">The Plugin</a></li>
<li><a href="#the-backend">The Backend</a></li>
<li><a href="#data-pipelines">Data Pipelines</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="how-does-it-work" tabindex="-1">How does it work?</h2>
<p>StackIt is a google workspace add-on available with Google Sheets. It connects to data sources such as Chargebee and PostgreSQL using your credentials. Credentials are stored in a secure Google Cloud Platform (GCP) project. StackIt uses Google Cloud’s Secret Manager to store your credentials, which ensures that your credentials are encrypted and secure.</p>
<p>Chargbe credentials may look like this:<br>
[testingchargebee-stackit].chargebee.com<br>
djdiasjidusahdusa8na9sduaun9d_test_chargebee</p>
<p>Once connected, StackIt provides the flexibility to choose from the available columns of the source data. You can select specific columns, like <code>subscription</code> or <code>customers</code>, and then map these columns respectively to your Sheets. StackIt also offers you to selectively import nested fields of the columns. For example, you can select <code>subscription</code> with <code>subscription_id</code> and <code>subscription_status</code> to import these fields into your Google Sheets. You have the liberty to select as many fields as you like.</p>
<figure>
  <img src="/assets/img/stackit/stackit.png" alt="StackIt" style="width:100%">
  <figcaption>StackIt</figcaption>
</figure>
<p>By providing the freedom to choose and map columns and their nested fields, StackIt enables you to have fine-grained control over the imported data and ensure that the relevant data is imported into your Google Sheets.</p>
<p>The seamless integration into Google Sheets allows you to work with the imported data directly within your spreadsheet, making it easily accessible for analysis, visualization, and further processing.</p>
<p>Note: *<strong>StackIt does not store any of your data. It only acts as a bridge between your data sources and your Google Sheets.</strong></p>
<h3 id="infrastructure" tabindex="-1">Infrastructure</h3>
<p>The infrastructure of the entire StackIt is divided into three parts:-</p>
<ol>
<li>Plugin</li>
<li>The Backend</li>
<li>Data Pipelines</li>
</ol>
<h4 id="the-plugin" tabindex="-1">The Plugin</h4>
<p><strong>The Plugin</strong> is built using ReactJs, AppScript(Google’s version of JavaScript) and Network APIs. The code is structured into three segments:-</p>
<ul>
<li>The client-side code</li>
<li>The server-side code</li>
<li>The shared code</li>
</ul>
<p><strong>The client-side code</strong> is responsible for rendering the UI and handling user interactions, and is deployed on Google’s AppScript.
<strong>Clasp</strong> is a cmd tool that enables you to push your code to Google’s AppScript. It is similar to git but for AppScript. The client-side code, once built (the build folder in React ), is deployed on AppScript using Clasp. The plugin is rendered from those HTML files.</p>
<p><strong>The server-side code</strong>  written in AppScript, is responsible for handling the API calls and the business logic. It communicates with the StackIt backend and is deployed on Google’s AppScript. Clasp pushes the server-side code to AppScript, in the main file: <strong>Code .gs</strong>., which is the entry point for AppScript.</p>
<p><strong>The shared code</strong> contains the APIs that are used by all the sections of the client-side code.</p>
<p>The structure of the source code looks like this:</p>
<pre><code class="language-js">
-dist <span class="hljs-comment">// The final built source code that is deployed on AppScript via Clasp</span>
  -code.<span class="hljs-property">gs</span>
  -index.<span class="hljs-property">html</span>
  -about.<span class="hljs-property">html</span>
  -contact.<span class="hljs-property">html</span>
-public
-src  
    -client
      -index
      -about
      -contact  
    -build1  <span class="hljs-comment">// Transpiled React code --&gt;*HTML  index.html --&gt; moved to *dist </span>
    -build2  <span class="hljs-comment">// Transpiled React code --&gt;*HTML  about.html --&gt; moved to *dist</span>
    -src  
    -shared  <span class="hljs-comment">// Common APIs for all the separate React Screens</span>
  -server  
    -index.<span class="hljs-property">js</span> <span class="hljs-comment">// Entry point for AppScript --&gt; Code.gs  --&gt; moved to *dist</span>
    -ui.<span class="hljs-property">js</span> 
    -sheets.<span class="hljs-property">js</span> <span class="hljs-comment">//contains the spreadsheet APIs</span>
  -appsscript.<span class="hljs-property">json</span>  
  -package.<span class="hljs-property">json</span>
  -webpack.<span class="hljs-property">config</span>.<span class="hljs-property">js</span>  <span class="hljs-comment">// Webpack config file responsible for transpiring React and JS code</span>
  -.<span class="hljs-property">clasp</span>.<span class="hljs-property">json</span>  
</code></pre>
<p>The final built source code is deployed on AppScript using Clasp and looks like this:</p>
<pre><code class="language-js">
-appsscript.<span class="hljs-property">json</span>
-code.<span class="hljs-property">gs</span> <span class="hljs-comment">// Entry point for AppScript</span>
-index.<span class="hljs-property">html</span> <span class="hljs-comment">// The HTML file that renders the plugin</span>
-about.<span class="hljs-property">html</span>
-contact.<span class="hljs-property">html</span>

</code></pre>
<p>The AppScript code is deployed as a workspace add-on, the one that you see in the Google Sheets.</p>
<h4 id="the-backend" tabindex="-1">The Backend</h4>
<p>The StackIt backend is built using NodeJs and ExpressJs. It is deployed on the Google Cloud Platform. The backend is responsible for handling the API calls from the plugin and communicating with the data aggregators.</p>
<p>The entire backend is divided into three section:-</p>
<ol>
<li>The Backend</li>
<li>The Kafka Server</li>
<li>MongoDB</li>
</ol>
<p>The process of importing data from the data sources is divided into two roadways:-</p>
<ol>
<li>
<p>The plugin sends a request to the backend to import data from a particular data source.</p>
</li>
<li>
<p>The backend then sends a request to the data aggregator to fetch the data, stores it temporarily in <code>Kafka</code>, and sends a response to the plugin.</p>
</li>
</ol>
<p>The main backend can be thought of as a collection of microservices. Each microservice is responsible for handling a particular set of APIs. The backend is divided into five microservices:-</p>
<ol>
<li>
<p><strong>ASTRA</strong> - This is the identity management API. It is responsible for creating and managing users and their credentials.</p>
</li>
<li>
<p><strong>APOLLO</strong> - This is the configuration management API. It is responsible for creating, storing and managing the configurations of the users.</p>
</li>
<li>
<p><strong>NEXUS</strong> - This is the connection service API. It is responsible for creating and managing connections with the data aggregators.</p>
</li>
<li>
<p><strong>CHRONA</strong> - This is the schedule management API. It is responsible for creating and managing schedules for the data import.</p>
</li>
<li>
<p><strong>ZEUS</strong> - This is the master data management API. It stores the main data in <strong>MongoDB</strong>.</p>
</li>
</ol>
<p>The server is not directly connected to the internet. We use a <code>reverse proxy</code> and a <code>NAT gateway</code> to connect the server to the internet. The server is white-listed to only allow requests from the reverse proxy.</p>
<figure>
  <img src="/assets/img/stackit/backend.png" alt="StackIt" style="width:100%">
  <figcaption>StackIt- Backend</figcaption>
</figure>
<p><strong>Outbound Requests</strong> -</p>
<p>The backend server is connected to the internet via a NAT Gateway. The NAT Gateway is a network component that allows the backend server to connect to the internet without exposing the server to the internet.</p>
<p><strong>Inbound Requests</strong> -</p>
<p>Data flows in through a reverse proxy. The reverse proxy is a server that sits in front of the server and forwards client requests to the server. It also caches the responses from the server and sends them back to the client without having to forward the request to the server. This reduces the load and improves the performance.</p>
<p>White-listing is a security mechanism that allows you to create a list of trusted IP addresses or IP ranges from which your users can access your backend server. The server is white-listed to only allow requests from the reverse proxy.</p>
<p>The master data in stored in <strong>MongoDB</strong></p>
<h4 id="data-pipelines" tabindex="-1">Data Pipelines</h4>
<p>The data pipelines are built using <code>python</code>, and <code>Apache Kafka</code>. Kafka is a distributed streaming platform that is used to build real-time data pipelines and streaming apps. It is horizontally scalable, fault-tolerant, and extremely fast. <strong>It is used to store the data temporarily before it is imported into the Google Sheets</strong>.</p>

            <hr />
            <div class="footer">
              Suggestions or corrections?
              <a
                href="mailto:anubhabr50@gmail.com?subject=Here's%20a%20suggestion/feedback!&amp;body=Hello%2C%20I%20think%20you%20need%20to%20work%20on..."
                >Send me a message</a
              >.
            </div>
          </div>
        </section>
      </div>
    </div>
    <script src="/assets/js/main.js"></script>
  </body>
</html>
